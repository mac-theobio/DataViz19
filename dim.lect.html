<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>high-dimensional examples</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="main.css" type="text/css" />
</head>
<body>
<header class="site-header">
<div class="wrapper">
	<h1 class="title">
		<a href="index.html">Biology 744, McMaster University</a>
	</h1>
	<div style="text-align:center">
		<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Minard.png/640px-Minard.png" width=80%>
	</div>
</div>
</header>
<div id="header">
<h1 class="title">high-dimensional examples</h1>
</div>
<h2 id="packages">Packages</h2>
<pre><code>library(factoextra)
library(pheatmap)
library(tidyverse)
theme_set(theme_bw())</code></pre>
<h2 id="data">Data</h2>
<p>We usually think of high-dimensional data as consisting of multiple <em>measures</em> on a group of samples:</p>
<ul>
<li>Number of “reads” of different bacterial proteins from a set of soil samples</li>
<li>Decathlon scores from different competitors</li>
<li>Health measures from different children</li>
</ul>
<h2 id="types-of-measures">Types of measures</h2>
<p>Many scientists traditionally think of high-dimensional data as having parallel, continuous measures:</p>
<ul>
<li>read matrices from soil samples</li>
</ul>
<p>These may be complemented by a smaller number of “metadata” variables, which may be more diverse in type (count, categorical, etc.):</p>
<ul>
<li>environmental variables associated with soil samples</li>
</ul>
<p>More and more datasets don’t follow this:</p>
<ul>
<li>Canadian longitudinal study on aging has a huge number of variables per person with a wide mixture of types</li>
</ul>
<h2 id="duality">Duality</h2>
<p>We study the rows (samples) using the columns (measures)</p>
<ul>
<li>What do the observed proteins tell us about the functional relationships between different soil samples?</li>
<li>What does differential success in decathlon events tell us about the athletes?</li>
</ul>
<p>But we can also do the opposite!</p>
<ul>
<li>What do measurements across soil samples tell us about the functional relationships between proteins?</li>
<li>What does differential success of athletes tell us about the relationship between events?</li>
</ul>
<h2 id="decathlon-events">Decathlon events</h2>
<pre><code>print(names(decathlon2))  ## from factoextra pkg

##  [1] &quot;X100m&quot;        &quot;Long.jump&quot;    &quot;Shot.put&quot;     &quot;High.jump&quot;   
##  [5] &quot;X400m&quot;        &quot;X110m.hurdle&quot; &quot;Discus&quot;       &quot;Pole.vault&quot;  
##  [9] &quot;Javeline&quot;     &quot;X1500m&quot;       &quot;Rank&quot;         &quot;Points&quot;      
## [13] &quot;Competition&quot;</code></pre>
<h2 id="decathlon-frame">Decathlon frame</h2>
<pre><code>dec_frame &lt;- (decathlon2[1:10]
        %&gt;% as_tibble()
    %&gt;% rename_all(sub, pattern=&quot;^X&quot;, replacement=&quot;Run_&quot;)
    %&gt;% mutate_at(vars(contains(&#39;Run_&#39;)), ~(-1*.))
    %&gt;% rename_all(sub, pattern=&quot;110m.&quot;, replacement=&quot;&quot;)
    %&gt;% mutate_all(~c(drop(scale(.))))
)</code></pre>
<h2 id="pairs-plot">Pairs plot</h2>
<div class="figure">
<img src="iris.Rout.png" alt="" />
<p class="caption">Iris pairs plot (iris.R)</p>
</div>
<hr />
<ul>
<li>Slow, and not very good for more than 5 or 6 variables</li>
<li>Base R may be faster for quick viz</li>
</ul>
<h2 id="heatmap">Heatmap</h2>
<pre><code>dec_mat &lt;- as.matrix(dec_frame)
heatmap(dec_mat)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/dec_heatmap-1.png" /></p>
<h2 id="heatmap-again">Heatmap again</h2>
<pre><code>heatmap(t(dec_mat))</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/dec_t_heatmap-1.png" /></p>
<h2 id="correlation-heatmap">Correlation heatmap</h2>
<pre><code>pheatmap(cor(dec_mat), cell.width = 10, cell.height = 10)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/corr_heatmap-1.png" /></p>
<p>Better for visualizing groups of events</p>
<h2 id="athelete-correlations">Athelete correlations</h2>
<pre><code>pheatmap(cor(t(dec_mat)), cell.width = 4, cell.height = 4)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/corr_athlete-1.png" /></p>
<p>Better for visualizing groups of events</p>
<h2 id="pca">PCA</h2>
<p>A beautiful decomposition based on the idea that data points are points in a Euclidean space</p>
<ul>
<li>Need to think about scaling</li>
</ul>
<p>We can think about the PCA as a decomposition (making observed points from idealized points)</p>
<ul>
<li>And relax it by requiring <em>non-negative</em> combinations of <em>non-negative</em> components (NMF)</li>
</ul>
<p>Or we can think about it as minimizing distances:</p>
<ul>
<li>And relax it with non-Euclidean distances (PCoA)</li>
<li>… or a rank-based approach (NMDS)</li>
</ul>
<h2 id="pca-decomposition">PCA decomposition</h2>
<pre><code>pca_ath &lt;- prcomp(dec_mat, scale=TRUE)
fviz_screeplot(pca_ath)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/pca-1.png" /></p>
<h2 id="individuals">Individuals</h2>
<pre><code>fviz_pca_ind(pca_ath)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/fviz_ind-1.png" /></p>
<h2 id="components">Components</h2>
<pre><code>fviz_pca_var(pca_ath)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/fviz_components-1.png" /></p>
<hr />
<pre><code>fviz_pca_var(pca_ath, axes=c(2, 3))</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/fviz_altcomponents-1.png" /></p>
<h2 id="biplot">Biplot</h2>
<p>View scores and components:</p>
<pre><code>fviz_pca_biplot(pca_ath)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/fviz_biplot-1.png" /></p>
<h2 id="loadings">Loadings</h2>
<pre><code>load &lt;- pca_ath$sdev * pca_ath$rotation
pheatmap(load, cluster_cols=FALSE)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/fviz_loadplot-1.png" /></p>
<p>WRONG!!!!</p>
<h2 id="non-metric-dimensional-scaling">Non-metric dimensional scaling</h2>
<pre><code>library(vegan)

## Loading required package: permute

## Loading required package: lattice

## This is vegan 2.5-6

mds &lt;- metaMDS(dec_mat, distance=&quot;euclidean&quot;)

## &#39;comm&#39; has negative data: &#39;autotransform&#39;, &#39;noshare&#39; and &#39;wascores&#39; set to FALSE

## Run 0 stress 0.175356 
<<<<<<< HEAD
## Run 1 stress 0.1754596 
## ... Procrustes: rmse 0.02210455  max resid 0.07935155 
## Run 2 stress 0.1975368 
## Run 3 stress 0.2037007 
## Run 4 stress 0.2014761 
## Run 5 stress 0.1783895 
## Run 6 stress 0.175356 
## ... Procrustes: rmse 3.582014e-05  max resid 0.0001273055 
## ... Similar to previous best
## Run 7 stress 0.2023231 
## Run 8 stress 0.1788122 
## Run 9 stress 0.1783895 
## Run 10 stress 0.2081909 
## Run 11 stress 0.1787378 
## Run 12 stress 0.2031064 
## Run 13 stress 0.1787387 
## Run 14 stress 0.1754591 
## ... Procrustes: rmse 0.02204878  max resid 0.0792881 
## Run 15 stress 0.1783896 
## Run 16 stress 0.2838306 
## Run 17 stress 0.1950852 
## Run 18 stress 0.2957943 
## Run 19 stress 0.1783901 
## Run 20 stress 0.2043724 
=======
## Run 1 stress 0.1783895 
## Run 2 stress 0.175356 
## ... Procrustes: rmse 1.893988e-05  max resid 6.399532e-05 
## ... Similar to previous best
## Run 3 stress 0.1754593 
## ... Procrustes: rmse 0.02191505  max resid 0.07906864 
## Run 4 stress 0.1754604 
## ... Procrustes: rmse 0.02239939  max resid 0.0807043 
## Run 5 stress 0.2050859 
## Run 6 stress 0.2856552 
## Run 7 stress 0.1788132 
## Run 8 stress 0.1788118 
## Run 9 stress 0.2050859 
## Run 10 stress 0.17546 
## ... Procrustes: rmse 0.02236373  max resid 0.08050568 
## Run 11 stress 0.1950849 
## Run 12 stress 0.3882253 
## Run 13 stress 0.1783896 
## Run 14 stress 0.2045531 
## Run 15 stress 0.1783895 
## Run 16 stress 0.2819848 
## Run 17 stress 0.1754597 
## ... Procrustes: rmse 0.0222582  max resid 0.07995142 
## Run 18 stress 0.2032167 
## Run 19 stress 0.214071 
## Run 20 stress 0.2028353 
>>>>>>> refs/remotes/origin/gh-pages
## *** Solution reached</code></pre>
<h2 id="nmds-plot">Nmds plot</h2>
<pre><code>plot(mds)

## species scores not available</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/nmds_plot-1.png" /></p>
<p>The biplot is hard (but we can help you if you want to do it)</p>
<h2 id="parallel-co-ordinates">Parallel co-ordinates</h2>
<pre><code>library(GGally)

## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2

## 
## Attaching package: &#39;GGally&#39;

## The following object is masked from &#39;package:dplyr&#39;:
## 
<<<<<<< HEAD
##     nasa

ggparcoord(dec_frame)</code></pre>
=======
##     nasa</code></pre>
<hr />
<pre><code>ggparcoord(dec_frame)</code></pre>
>>>>>>> refs/remotes/origin/gh-pages
<p><img src="dim.lect_files/figure-markdown_strict/parcor-1.png" /></p>
<h2 id="dual-view">Dual view</h2>
<pre><code>library(directlabels)
ath_frame &lt;- (
    as.data.frame(t(as.matrix(dec_frame)))
    %&gt;% mutate(event=names(dec_frame))
)
ggparcoord(ath_frame)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/parcorath-1.png" /></p>
<hr />
<pre><code>ggparcoord(ath_frame, groupColumn=&quot;event&quot;)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/parcorgroup-1.png" /></p>
<h2 id="andrews-plots">Andrews plots</h2>
<pre><code>library(andrews)
<<<<<<< HEAD
andrews(dec_frame)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/andrews-1.png" /></p>
<hr />
=======
## andrews::numarray() **does not like tibbles**
andrews(as.data.frame(dec_frame))</code></pre>
<h2 id="section"><img src="dim.lect_files/figure-markdown_strict/andrews-1.png" /></h2>
>>>>>>> refs/remotes/origin/gh-pages
<pre><code>andrews(ath_frame)</code></pre>
<p><img src="dim.lect_files/figure-markdown_strict/andrews_ath-1.png" /></p>
<h2 id="radar-charts">Radar charts</h2>
<p>Not implemented; may suffer similar problems</p>
<h2 id="ordering">Ordering</h2>
<p>Many of these charts might work if the variables were in a suitable order:</p>
<ul>
<<<<<<< HEAD
<li>heatmap provides an order
=======
<li><p>heatmap provides an order</p>
>>>>>>> refs/remotes/origin/gh-pages
<ul>
<li>hierarchical</li>
</ul></li>
<li><p>other ordering methods take a more holistic view</p></li>
<<<<<<< HEAD
<li>PCA and other decompositions could also provide an order!
=======
<li><p>PCA and other decompositions could also provide an order!</p>
>>>>>>> refs/remotes/origin/gh-pages
<ul>
<li>Should we combine PCA with Andrews or parcoord?</li>
</ul></li>
</ul>
<div id="footer">
	<div style="text-align:center">
		<a href="index.html">Course home page</a>
	</div>
</div>
</body>
</html>
